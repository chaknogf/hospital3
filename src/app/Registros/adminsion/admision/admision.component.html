<h2 class="titulo-principal text-center">
  {{ enEdicion ? "Editar Admisión" : "Nueva Admisión" }}
</h2>

<div class="botonera">
  <button type="button" class="btn btn-cancelar" (click)="volver()">
    <span [innerHTML]="cancelIcon"></span>
    Cancelar
  </button>

  <button type="submit" class="btn btn-guardar" (click)="guardar()">
    <span [innerHTML]="saveIcon"></span>
    Guardar
  </button>
</div>

<form [formGroup]="form" class="formulario-moderno" (ngSubmit)="guardar()">
  <!-- Anti-autocompletado -->
  <input type="text" name="fakeusernameremembered" style="display: none" />
  <input type="password" name="fakepasswordremembered" style="display: none" />

  <!-- Datos del Paciente Compacto y Centrado -->
  <fieldset class="grupo ficha-paciente text-center">
    <legend>Datos del Paciente</legend>

    <!-- Línea 1: Nombre completo -->
    <div class="resumen linea-nombre justify-center">
      <span class="nombre-completo">
        {{ paciente.nombre.primer_nombre }}
        {{ paciente.nombre.segundo_nombre }}
        {{ paciente.nombre.otro_nombre }}
        {{ paciente.nombre.primer_apellido }}
        {{ paciente.nombre.segundo_apellido }}
        {{ paciente.nombre.apellido_casada }}
      </span>
    </div>

    <!-- Línea 2: CUI | Expediente | Fecha de nacimiento / Edad -->
    <div class="resumen linea-identidad justify-center">
      <span class="dato">CUI: {{ paciente.cui | cui }}</span>
      <span class="dato">Expediente: {{ paciente.expediente }}</span>
      <span class="dato"
        >Nacimiento: {{ paciente.fecha_nacimiento | date : "dd/MM/yyyy" }} ({{
          paciente.fecha_nacimiento | edad
        }})</span
      >
    </div>

    <!-- Línea 3: Sexo | Dirección | Teléfonos -->
    <div class="resumen linea-contacto justify-center">
      <span class="dato icono-sexo">
        <ng-container *ngIf="paciente.sexo === 'M'">
          <span [innerHTML]="manIcon"></span>
        </ng-container>
        <ng-container *ngIf="paciente.sexo === 'F'">
          <span [innerHTML]="womanIcon"></span>
        </ng-container>
        {{ paciente.sexo | datosExtra : "sexo" }}
      </span>
      <span class="dato direccion">
        {{ paciente.contacto?.domicilio }},
        {{ paciente.contacto?.municipio | datosExtra : "vecindad" }}
      </span>
      <span class="dato telefono" *ngIf="paciente.contacto?.telefonos">
        Tel: {{ paciente.contacto?.telefonos }}
      </span>
    </div>
  </fieldset>

  <!-- Admisión -->
  <fieldset class="grupo">
    <legend>Admisión</legend>

    <label>Especialidad</label>
    <select formControlName="especialidad" class="input-select">
      <option *ngFor="let e of especialidades" [value]="e.value">
        {{ e.label | titlecase }}
      </option>
    </select>

    <label *ngIf="form.get('documento')?.value">Hoja de Emergencia</label>
    <input
      type="text"
      id="documento"
      formControlName="documento"
      *ngIf="form.get('documento')?.value"
      placeholder="Hoja de Emergencia"
      name="hoja_emergencia"
      autocomplete="off"
      class="input-text"
    />

    <label>Tipo de consulta</label>
    <select formControlName="tipo_consulta" class="input-select">
      <option *ngFor="let t of tipoConsulta" [value]="t.value" disabled>
        {{ t.label | titlecase }}
      </option>
    </select>

    <label>Servicio</label>
    <select formControlName="servicio" class="input-select">
      <option *ngFor="let s of servicios" [value]="s.value">
        {{ s.label | titlecase }}
      </option>
    </select>

    <label>Fecha de Admisión</label>
    <input type="date" formControlName="fecha_consulta" class="input-text" />

    <label>Hora de Admisión</label>
    <input type="time" formControlName="hora_consulta" class="input-text" />
  </fieldset>

  <!-- Indicadores -->
  <fieldset class="grupo" [formGroupName]="'indicadores'">
    <legend>Indicadores</legend>

    <div class="checkbox-group">
      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="estudiante_publico" />
        <span>Estudiante Público</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="empleado_publico" />
        <span>Empleado Público</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="accidente_laboral" />
        <span>Accidente Laboral</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="discapacidad" />
        <span>Discapacidad</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="embarazo" />
        <span>Embarazo</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="arma_fuego" />
        <span>Arma de Fuego</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="arma_blanca" />
        <span>Arma Blanca</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="ambulancia" />
        <span>Ambulancia</span>
      </label>

      <label class="aurora-checkbox">
        <input type="checkbox" formControlName="accidente_transito" />
        <span>Accidente Tránsito</span>
      </label>
    </div>
  </fieldset>
</form>
