<!-- Botones de control -->
<div class="botones bg-white no-imprimir">
  <button (click)="regresar()" [disabled]="isLoading()">
    <span [innerHTML]="icons['back']"></span>
  </button>
  <button (click)="imprimir()" [disabled]="isLoading()">
    <span [innerHTML]="icons['print']"></span>
  </button>
</div>

<!-- Mostrar errores -->
<div *ngIf="error()" class="alert alert-danger no-imprimir">
  {{ error() }}
</div>

<!-- Loading -->
<div *ngIf="isLoading()" class="alert alert-info no-imprimir">
  Cargando información...
</div>

<!-- Documento Principal -->
<div
  class="container-impresion imprimir-esto blanco"
  *ngIf="detalleVisible() && consulta() && paciente()"
>
  <!-- HEADER -->
  <div class="aurora-header">
    <div class="aurora-textos">
      <h3>Hoja de Atención en Emergencias</h3>
      <h4>Ministerio de Salud Pública y Asistencia Social</h4>
      <h5>Hospital General Tipo I de Tecpán Guatemala</h5>
    </div>
    <span class="logo" [innerHTML]="icons['logo']"></span>
  </div>

  <!-- DOCUMENTO Y CONSULTA -->
  <div>
    <h4>Hoja de Emergencia: {{ consulta()?.documento }}</h4>
    <h6 class="text-end mr-5">No. consulta: {{ consulta()?.id }}</h6>
  </div>

  <!-- SERVICIOS/ESPECIALIDADES -->
  <div class="d-flex doc-section">
    <h6>SERVICIOS:</h6>
    <div
      class="especialidades-hoja d-flex justify-content-between flex-wrap gap-4 ms-3"
    >
      <div
        *ngFor="let esp of especialidades"
        class="especialidad-cuadro d-flex flex-column align-items-center"
      >
        <label>{{ esp.label }}</label>
        <span
          *ngIf="consulta()?.especialidad !== esp.value"
          class="text-black"
          [innerHTML]="icons['cuadroBlanco']"
        ></span>
        <span
          *ngIf="consulta()?.especialidad === esp.value"
          class="text-black"
          [innerHTML]="icons['cuadroNegro']"
        ></span>
      </div>
    </div>
  </div>

  <!-- FECHA, HORA Y EXPEDIENTE -->
  <div class="d-flex justify-content-between doc-section">
    <div>
      <label>Fecha:</label>
      <p>{{ consulta()?.fecha_consulta | date : "dd/MM/yyyy" }}</p>
    </div>
    <div>
      <label>Hora:</label>
      <p>{{ consulta()?.hora_consulta | time }}</p>
    </div>
    <div>
      <label>Expediente:</label>
      <p>{{ consulta()?.expediente }}</p>
    </div>
  </div>

  <!-- DATOS GENERALES -->
  <div class="doc-section">
    <h6>DATOS GENERALES</h6>

    <!-- Fila 1: Nombre, Fecha Nacimiento, Edad -->
    <div class="d-flex justify-content-between p-0 m-0 borderline">
      <div class="mx-2">
        <label>Nombre del Paciente:</label>
        <p>{{ nombreCompleto() }}</p>
      </div>
      <div>
        <label>Fecha de Nacimiento:</label>
        <p>{{ paciente()?.fecha_nacimiento | date : "dd/MM/yyyy" }}</p>
      </div>
      <div class="mx-2">
        <label>Edad:</label>
        <p>{{ paciente()?.fecha_nacimiento | edad }}</p>
      </div>
    </div>

    <!-- Fila 2: Sexo, DPI, Dirección -->
    <div class="d-flex justify-content-between p-0 m-0 borderline">
      <div class="mx-2">
        <label>Sexo:</label>
        <p>{{ paciente()?.sexo | datosExtra : "sexo" }}</p>
      </div>
      <div>
        <label>DPI:</label>
        <p>{{ paciente()?.cui | cui }}</p>
      </div>
      <div class="mx-2">
        <label>Dirección:</label>
        <p>{{ direccionCompleta() }}</p>
      </div>
    </div>

    <!-- Fila 3: Responsable, Parentesco, Teléfono -->
    <div class="d-flex justify-content-between p-0 m-0 borderline">
      <div class="mx-2">
        <label>Responsable:</label>
        <p>{{ responsable()?.nombre || "N/A" }}</p>
      </div>
      <div>
        <label>Parentesco:</label>
        <p>{{ responsable()?.parentesco | datosExtra : "parentesco" }}</p>
      </div>
      <div class="mx-2">
        <label>Teléfono:</label>
        <p>{{ responsable()?.telefonos || "N/A" }}</p>
      </div>
    </div>

    <!-- INDICADORES / CUADROS -->
    <div class="d-flex justify-content-between doc-section">
      <h6></h6>

      <div class="centered-container">
        <label>Traído por Bomberos</label>
        <span
          *ngIf="!getIndicador('traido_bomberos')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('traido_bomberos')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>

      <div class="centered-container">
        <label>Accidente Tránsito</label>
        <span
          *ngIf="!getIndicador('accidente_transito')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('accidente_transito')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>

      <div class="centered-container">
        <label>Arma Blanca</label>
        <span
          *ngIf="!getIndicador('arma_blanca')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('arma_blanca')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>

      <div class="centered-container">
        <label>Arma de Fuego</label>
        <span
          *ngIf="!getIndicador('arma_fuego')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('arma_fuego')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>

      <div class="centered-container">
        <label>Estudiante Escuela Pública</label>
        <span
          *ngIf="!getIndicador('estudiante_publico')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('estudiante_publico')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>

      <div class="centered-container">
        <label>Accidente Laboral</label>
        <span
          *ngIf="!getIndicador('accidente_laboral')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('accidente_laboral')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>

      <div class="mx-2 centered-container">
        <label>Personal de Hospital</label>
        <span
          *ngIf="!getIndicador('personal_hospital')"
          [innerHTML]="icons['cuadroBlanco']"
          class="text-black"
        ></span>
        <span
          *ngIf="getIndicador('personal_hospital')"
          [innerHTML]="icons['cuadroNegro']"
          class="text-black"
        ></span>
      </div>
    </div>

    <!-- MOTIVO DE LA CONSULTA -->
    <div class="doc-section_">
      <div class="d-flex justify-content-between">
        <div class="borderline">
          <h6>MOTIVO DE LA CONSULTA:</h6>
          <p class="line"></p>
          <p class="line"></p>
        </div>
      </div>
    </div>

    <!-- HISTORIA DE LA ENFERMEDAD ACTUAL -->
    <div class="doc-section d-flex justify-content-between">
      <div>
        <label>Historia de la enfermedad actual:</label>
        <p></p>
      </div>
    </div>

    <!-- ANTECEDENTES -->
    <div class="doc-section">
      <h6>ANTECEDENTES</h6>

      <div class="d-flex justify-content-between">
        <div class="borderline">
          <label>Familiares:</label>
          <p class="line"></p>
        </div>
        <div class="borderline">
          <label>Médicos:</label>
          <p class="line"></p>
        </div>
        <div class="borderline">
          <label>Traumáticos:</label>
          <p class="line"></p>
        </div>
      </div>

      <div class="d-flex justify-content-between">
        <div class="borderline">
          <label>Quirúrgicos:</label>
          <p class="line"></p>
        </div>
        <div class="borderline">
          <label>Alérgicos:</label>
          <p class="line"></p>
        </div>
      </div>

      <!-- Antecedentes Ginecológicos -->
      <div class="d-flex justify-content-between">
        <div class="borderline" style="width: 100%">
          <label>Ginecológicos:</label>
          <div class="d-flex justify-content-between gap-2">
            <p class="mx-2">G:_________</p>
            <p>P:_________</p>
            <p>C:_________</p>
            <p>A:_________</p>
            <p>HV:_________</p>
            <p>HM:_________</p>
            <p>FUR:_________</p>
            <p class="mx-2">FPP:_________</p>
          </div>
          <div class="d-flex justify-content-between gap-2">
            <p class="mx-3">Menarquía:______________</p>
            <p>Ciclos:________________</p>
            <p>FUP:_______________</p>
            <p class="mx-3">Control_PN:___________</p>
          </div>
        </div>
      </div>

      <div class="d-flex justify-content-between">
        <div class="borderline">
          <label>Otros Antecedentes de importancia:</label>
          <p class="line"></p>
        </div>
      </div>
    </div>

    <!-- EXAMEN FÍSICO -->
    <div class="doc-section_">
      <div class="d-flex justify-content-between">
        <div class="borderline" style="width: 100%">
          <h6>EXAMEN FÍSICO:</h6>
          <div class="d-flex justify-content-between gap-2">
            <p class="mx-2">P/A:_________mmHg</p>
            <p>FC:_________lpm</p>
            <p>FR:_________rpm</p>
            <p>SatO2:_________%</p>
            <p class="mx-2">Temp:_________°C</p>
          </div>
          <div class="d-flex justify-content-between gap-2">
            <p class="mx-2">Peso:_________</p>
            <p>Talla/longitud:_________cm</p>
            <p>P/T:_________</p>
            <p>P/T:_________</p>
            <p>T/E:_________</p>
            <p class="mx-2">P/E:_________</p>
          </div>
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
        </div>
      </div>
    </div>

    <!-- IMPRESIÓN CLÍNICA -->
    <div class="doc-section">
      <h6>IMPRESIÓN CLÍNICA:</h6>
      <p class="line"></p>
      <p class="line"></p>
    </div>

    <!-- ÓRDENES MÉDICAS -->
    <div class="doc-section">
      <h6>ÓRDENES MÉDICAS:</h6>
      <div class="d-flex gap-2">
        <div class="borderline" style="flex: 1">
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
        </div>
        <div class="borderline" style="flex: 1">
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
        </div>
        <div class="borderline" style="flex: 1">
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
          <div class="d-flex justify-content-between gap-2">
            <p class="p-0 m-0">Fecha:</p>
            <p class="p-0 m-0">Hora:</p>
            <p class="p-0 m-0">Firma:</p>
          </div>
        </div>
      </div>
    </div>

    <!-- INGRESO/EGRESO -->
    <div class="doc-section">
      <div class="d-flex justify-content-around">
        <div>
          <label>Ingreso:</label>
          <span [innerHTML]="icons['cuadroBlanco']" class="text-black"></span>
        </div>
        <div>
          <label>Servicio a donde ingresa:</label>
          <p class="line"></p>
        </div>
        <div>
          <label>Egreso:</label>
          <span [innerHTML]="icons['cuadroBlanco']" class="text-black"></span>
        </div>
      </div>
    </div>

    <!-- ÓRDENES DE EGRESO -->
    <div class="doc-section">
      <h6>ÓRDENES DE EGRESO:</h6>
      <div class="d-flex gap-2">
        <div class="borderline" style="flex: 1">
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
          <div class="d-flex justify-content-between gap-2">
            <p class="p-0 m-0">Fecha:</p>
            <p class="p-0 m-0">Hora:</p>
            <p class="p-0 m-0">Firma:</p>
          </div>
        </div>
        <div class="borderline" style="flex: 1">
          <p class="line"></p>
          <p class="line"></p>
          <p class="line"></p>
          <div class="d-flex justify-content-between gap-2">
            <p class="p-0 m-0">Fecha:</p>
            <p class="p-0 m-0">Hora:</p>
            <p class="p-0 m-0">Firma:</p>
          </div>
        </div>
      </div>
    </div>

    <!-- OBSERVACIONES -->
    <div class="doc-section">
      <h6>OBSERVACIONES:</h6>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
    </div>

    <!-- NOTAS DE ENFERMERÍA -->
    <div class="doc-section">
      <h6>NOTAS DE ENFERMERÍA:</h6>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <div class="d-flex justify-content-between gap-2">
        <p class="p-0 m-0">Fecha:</p>
        <p class="p-0 m-0">Hora:</p>
        <p class="p-0 m-0">Firma y Sello:</p>
      </div>
    </div>

    <!-- EGRESO CONTRAINDICADO -->
    <div class="doc-section">
      <h6>EGRESO CONTRAINDICADO:</h6>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <div class="d-flex justify-content-between gap-3 align-items-start">
        <p class="line" style="flex: 1">Firma del Paciente</p>
        <p class="line" style="flex: 1">Firma del Testigo</p>
        <p class="line" style="flex: 1">Firma y sello del Médico</p>
      </div>
    </div>

    <!-- NOTA DE DESCARGO -->
    <div class="doc-section">
      <h6>NOTA DE DESCARGO:</h6>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
      <p class="line"></p>
    </div>
  </div>
</div>
